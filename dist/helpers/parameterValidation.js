"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
const colorHelper_1 = require("./colorHelper");
class ParameterValidation {
    static checkPackageName(logger, name, value) {
        // Rules from here https://docs.npmjs.com/files/package.json
        // here https://github.com/npm/validate-npm-package-name
        // and here https://github.com/npm/npm-registry-couchapp/
        // blob/b31793881ff95c5bca5966a0a8bf8e5f7a801247/registry/modules.js#L93
        if (value === undefined || value === null || value.length === 0) {
            logger.error(name, "parameter is missing.");
            return false;
        }
        if (value.length > 214) {
            logger.error(name, "must be less than or equal to 214 characters.");
            return false;
        }
        if (value.toLowerCase() !== value) {
            logger.error(name, "must not have uppercase letters in it.");
            return false;
        }
        if (value[0] === "." || value[0] === "-" || value[0] === "_") {
            logger.error(name, "must not start with a dot, hyphen or underscore.");
            return false;
        }
        if (value.match(/[\/\\\(\)&\?#\|<>@:%\s\*'"!~`]/)) {
            logger.error(name, "must not have any special characters.");
            return false;
        }
        if (encodeURIComponent(value) !== value) {
            logger.error(name, "can't contain any non-URL-safe characters.");
            return false;
        }
        logger.info(name, { value });
        return true;
    }
    static checkPattern(logger, name, value, pattern, patternExplain) {
        if (value === undefined || value === null || value.length === 0) {
            logger.error(name, "parameter is missing.");
            return false;
        }
        if (pattern === undefined || pattern === null) {
            logger.error(name, "pattern is missing.");
            return false;
        }
        if (!pattern.test(value)) {
            logger.error(name, `does not match pattern ${patternExplain}.`);
            return false;
        }
        logger.info(name, { value });
        return true;
    }
    static checkOneOf(logger, name, value, values, error) {
        if (value === undefined || value === null || value.length === 0) {
            logger.error(name, "parameter is missing.");
            return false;
        }
        if (values === undefined || values === null || values.length === 0) {
            logger.error(name, "values are missing.");
            return false;
        }
        if (values.indexOf(value) === -1) {
            if (error) {
                logger.error(name, error);
            }
            else {
                logger.error(name, `does not match any of the possible values. [${values.join(",")}]`);
            }
            return false;
        }
        logger.info(name, { value });
        return true;
    }
    static notEmpty(logger, name, value) {
        if (value === undefined || value === null || value.length === 0) {
            logger.error(name, "parameter is missing.");
            return false;
        }
        logger.info(name, { value });
        return true;
    }
    static notEmptyNumber(logger, name, value) {
        if (value === undefined || value === null) {
            logger.error(name, "parameter is missing.");
            return false;
        }
        if (value <= 0) {
            logger.error(name, "must be greater than zero.");
            return false;
        }
        logger.info(name, { value });
        return true;
    }
    static isColor(logger, name, value) {
        if (value === undefined || value === null || value.length === 0) {
            logger.error(name, "parameter is missing.");
            return false;
        }
        if (!colorHelper_1.ColorHelper.isHex(value)) {
            logger.error(name, "is not a hex color.");
            return false;
        }
        logger.info(name, { value });
        return true;
    }
}
exports.ParameterValidation = ParameterValidation;

//# sourceMappingURL=data:application/json;charset=utf8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi4uLy4uL3NyYy9oZWxwZXJzL3BhcmFtZXRlclZhbGlkYXRpb24udHMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6Ijs7QUFJQSwrQ0FBNEM7QUFFNUM7SUFDVyxNQUFNLENBQUMsZ0JBQWdCLENBQUMsTUFBZSxFQUFFLElBQVksRUFBRSxLQUFnQztRQUMxRiw0REFBNEQ7UUFDNUQsd0RBQXdEO1FBQ3hELHlEQUF5RDtRQUN6RCx3RUFBd0U7UUFDeEUsRUFBRSxDQUFDLENBQUMsS0FBSyxLQUFLLFNBQVMsSUFBSSxLQUFLLEtBQUssSUFBSSxJQUFJLEtBQUssQ0FBQyxNQUFNLEtBQUssQ0FBQyxDQUFDLENBQUMsQ0FBQztZQUM5RCxNQUFNLENBQUMsS0FBSyxDQUFDLElBQUksRUFBRSx1QkFBdUIsQ0FBQyxDQUFDO1lBQzVDLE1BQU0sQ0FBQyxLQUFLLENBQUM7UUFDakIsQ0FBQztRQUVELEVBQUUsQ0FBQyxDQUFDLEtBQUssQ0FBQyxNQUFNLEdBQUcsR0FBRyxDQUFDLENBQUMsQ0FBQztZQUNyQixNQUFNLENBQUMsS0FBSyxDQUFDLElBQUksRUFBRSwrQ0FBK0MsQ0FBQyxDQUFDO1lBQ3BFLE1BQU0sQ0FBQyxLQUFLLENBQUM7UUFDakIsQ0FBQztRQUVELEVBQUUsQ0FBQyxDQUFDLEtBQUssQ0FBQyxXQUFXLEVBQUUsS0FBSyxLQUFLLENBQUMsQ0FBQyxDQUFDO1lBQ2hDLE1BQU0sQ0FBQyxLQUFLLENBQUMsSUFBSSxFQUFFLHdDQUF3QyxDQUFDLENBQUM7WUFDN0QsTUFBTSxDQUFDLEtBQUssQ0FBQztRQUNqQixDQUFDO1FBRUQsRUFBRSxDQUFDLENBQUMsS0FBSyxDQUFDLENBQUMsQ0FBQyxLQUFLLEdBQUcsSUFBSSxLQUFLLENBQUMsQ0FBQyxDQUFDLEtBQUssR0FBRyxJQUFJLEtBQUssQ0FBQyxDQUFDLENBQUMsS0FBSyxHQUFHLENBQUMsQ0FBQyxDQUFDO1lBQzNELE1BQU0sQ0FBQyxLQUFLLENBQUMsSUFBSSxFQUFFLGtEQUFrRCxDQUFDLENBQUM7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Q0FBQztRQUNqQixDQUFDO1FBRUQsTUFBTSxDQUFDLElBQUksQ0FBQyxJQUFJLEVBQUUsRUFBRSxLQUFLLEVBQUUsQ0FBQyxDQUFDO1FBRTdCLE1BQU0sQ0FBQyxJQUFJLENBQUM7SUFDaEIsQ0FBQztJQUVNLE1BQU0sQ0FBQyxPQUFPLENBQUMsTUFBZSxFQUFFLElBQVksRUFBRSxLQUFnQztRQUNqRixFQUFFLENBQUMsQ0FBQyxLQUFLLEtBQUssU0FBUyxJQUFJLEtBQUssS0FBSyxJQUFJLElBQUksS0FBSyxDQUFDLE1BQU0sS0FBSyxDQUFDLENBQUMsQ0FBQyxDQUFDO1lBQzlELE1BQU0sQ0FBQyxLQUFLLENBQUMsSUFBSSxFQUFFLHVCQUF1QixDQUFDLENBQUM7WUFDNUMsTUFBTSxDQUFDLEtBQUssQ0FBQztRQUNqQixDQUFDO1FBRUQsRUFBRSxDQUFDLENBQUMsQ0FBQyx5QkFBVyxDQUFDLEtBQUssQ0FBQyxLQUFLLENBQUMsQ0FBQyxDQUFDLENBQUM7WUFDNUIsTUFBTSxDQUFDLEtBQUssQ0FBQyxJQUFJLEVBQUUscUJBQXFCLENBQUMsQ0FBQztZQUMxQyxNQUFNLENBQUMsS0FBSyxDQUFDO1FBQ2pCLENBQUM7UUFFRCxNQUFNLENBQUMsSUFBSSxDQUFDLElBQUksRUFBRSxFQUFFLEtBQUssRUFBRSxDQUFDLENBQUM7UUFFN0IsTUFBTSxDQUFDLElBQUksQ0FBQztJQUNoQixDQUFDO0NBQ0o7QUFqSUQsa0RBaUlDIiwiZmlsZSI6ImhlbHBlcnMvcGFyYW1ldGVyVmFsaWRhdGlvbi5qcyIsInNvdXJjZXNDb250ZW50IjpbIi8qKlxuICogUGFyYW1ldGVyIHZhbGlkYXRpb24uXG4gKi9cbmltcG9ydCB7IElMb2dnZXIgfSBmcm9tIFwiLi4vaW50ZXJmYWNlcy9JTG9nZ2VyXCI7XG5pbXBvcnQgeyBDb2xvckhlbHBlciB9IGZyb20gXCIuL2NvbG9ySGVscGVyXCI7XG5cbmV4cG9ydCBjbGFzcyBQYXJhbWV0ZXJWYWxpZGF0aW9uIHtcbiAgICBwdWJsaWMgc3RhdGljIGNoZWNrUGFja2FnZU5hbWUobG9nZ2VyOiBJTG9nZ2VyLCBuYW1lOiBzdHJpbmcsIHZhbHVlOiBzdHJpbmcgfCB1bmRlZmluZWQgfCBudWxsKTogYm9vbGVhbiB7XG4gICAgICAgIC8vIFJ1bGVzIGZyb20gaGVyZSBodHRwczovL2RvY3MubnBtanMuY29tL2ZpbGVzL3BhY2thZ2UuanNvblxuICAgICAgICAvLyBoZXJlIGh0dHBzOi8vZ2l0aHViLmNvbS9ucG0vdmFsaWRhdGUtbnBtLXBhY2thZ2UtbmFtZVxuICAgICAgICAvLyBhbmQgaGVyZSBodHRwczovL2dpdGh1Yi5jb20vbnBtL25wbS1yZWdpc3RyeS1jb3VjaGFwcC9cbiAgICAgICAgLy8gYmxvYi9iMzE3OTM4ODFmZjk1YzViY2E1OTY2YTBhOGJmOGU1ZjdhODAxMjQ3L3JlZ2lzdHJ5L21vZHVsZXMuanMjTDkzXG4gICAgICAgIGlmICh2YWx1ZSA9PT0gdW5kZWZpbmVkIHx8IHZhbHVlID09PSBudWxsIHx8IHZhbHVlLmxlbmd0aCA9PT0gMCkge1xuICAgICAgICAgICAgbG9nZ2VyLmVycm9yKG5hbWUsIFwicGFyYW1ldGVyIGlzIG1pc3NpbmcuXCIpO1xuICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgICAgICB9XG5cbiAgICAgICAgaWYgKHZhbHVlLmxlbmd0aCA+IDIxNCkge1xuICAgICAgICAgICAgbG9nZ2VyLmVycm9yKG5hbWUsIFwibXVzdCBiZSBsZXNzIHRoYW4gb3IgZXF1YWwgdG8gMjE0IGNoYXJhY3RlcnMuXCIpO1xuICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgICAgICB9XG5cbiAgICAgICAgaWYgKHZhbHVlLnRvTG93ZXJDYXNlKCkgIT09IHZhbHVlKSB7XG4gICAgICAgICAgICBsb2dnZXIuZXJyb3IobmFtZSwgXCJtdXN0IG5vdCBoYXZlIHVwcGVyY2FzZSBsZXR0ZXJzIGluIGl0LlwiKTtcbiAgICAgICAgICAgIHJldHVybiBmYWxzZTtcbiAgICAgICAgfVxuXG4gICAgICAgIGlmICh2YWx1ZVswXSA9PT0gXCIuXCIgfHwgdmFsdWVbMF0gPT09IFwiLVwiIHx8IHZhbHVlWzBdID09PSBcIl9cIikge1xuICAgICAgICAgICAgbG9nZ2VyLmVycm9yKG5hbWUsIFwibXVzdCBub3Qgc3RhcnQgd2l0aCBhIGRvdCwgaHlwaGVuIG9yIHVuZGVyc2NvcmUuXCIpO1xuICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgICAgICB9XG5cbiAgICAgICAgaWYgKHZhbHVlLm1hdGNoKC9bXFwvXFxcXFxcKFxcKSZcXD8jXFx8PD5AOiVcXHNcXConXCIhfmBdLykpIHtcbiAgICAgICAgICAgIGxvZ2dlci5lcnJvcihuYW1lLCBcIm11c3Qgbm90IGhhdmUgYW55IHNwZWNpYWwgY2hhcmFjdGVycy5cIik7XG4gICAgICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgICAgIH1cblxuICAgICAgICBpZiAoZW5jb2RlVVJJQ29tcG9uZW50KHZhbHVlKSAhPT0gdmFsdWUpIHtcbiAgICAgICAgICAgIGxvZ2dlci5lcnJvcihuYW1lLCBcImNhbid0IGNvbnRhaW4gYW55IG5vbi1VUkwtc2FmZSBjaGFyYWN0ZXJzLlwiKTtcbiAgICAgICAgICAgIHJldHVybiBmYWxzZTtcbiAgICAgICAgfVxuXG4gICAgICAgIGxvZ2dlci5pbmZvKG5hbWUsIHsgdmFsdWUgfSk7XG5cbiAgICAgICAgcmV0dXJuIHRydWU7XG4gICAgfVxuXG4gICAgcHVibGljIHN0YXRpYyBjaGVja1BhdHRlcm4obG9nZ2VyOiBJTG9nZ2VyLCBuYW1lOiBzdHJpbmcsIHZhbHVlOiBzdHJpbmcgfCB1bmRlZmluZWQgfCBudWxsLCBwYXR0ZXJuOiBSZWdFeHAsIHBhdHRlcm5FeHBsYWluOiBzdHJpbmcpOiBib29sZWFuIHtcbiAgICAgICAgaWYgKHZhbHVlID09PSB1bmRlZmluZWQgfHwgdmFsdWUgPT09IG51bGwgfHwgdmFsdWUubGVuZ3RoID09PSAwKSB7XG4gICAgICAgICAgICBsb2dnZXIuZXJyb3IobmFtZSwgXCJwYXJhbWV0ZXIgaXMgbWlzc2luZy5cIik7XG4gICAgICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgICAgIH1cblxuICAgICAgICBpZiAocGF0dGVybiA9PT0gdW5kZWZpbmVkIHx8IHBhdHRlcm4gPT09IG51bGwpIHtcbiAgICAgICAgICAgIGxvZ2dlci5lcnJvcihuYW1lLCBcInBhdHRlcm4gaXMgbWlzc2luZy5cIik7XG4gICAgICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgICAgIH1cblxuICAgICAgICBpZiAoIXBhdHRlcm4udGVzdCh2YWx1ZSkpIHtcbiAgICAgICAgICAgIGxvZ2dlci5lcnJvcihuYW1lLCBgZG9lcyBub3QgbWF0Y2ggcGF0dGVybiAke3BhdHRlcm5FeHBsYWlufS5gKTtcbiAgICAgICAgICAgIHJldHVybiBmYWxzZTtcbiAgICAgICAgfVxuXG4gICAgICAgIGxvZ2dlci5pbmZvKG5hbWUsIHsgdmFsdWUgfSk7XG5cbiAgICAgICAgcmV0dXJuIHRydWU7XG4gICAgfVxuXG4gICAgcHVibGljIHN0YXRpYyBjaGVja09uZU9mPFQgZXh0ZW5kcyBzdHJpbmc+KGxvZ2dlcjogSUxvZ2dlciwgbmFtZTogc3RyaW5nLCB2YWx1ZTogVCB8IHVuZGVmaW5lZCB8IG51bGwsIHZhbHVlczogVFtdLCBlcnJvcj86IHN0cmluZyk6IGJvb2xlYW4ge1xuICAgICAgICBpZiAodmFsdWUgPT09IHVuZGVmaW5lZCB8fCB2YWx1ZSA9PT0gbnVsbCB8fCB2YWx1ZS5sZW5ndGggPT09IDApIHtcbiAgICAgICAgICAgIGxvZ2dlci5lcnJvcihuYW1lLCBcInBhcmFtZXRlciBpcyBtaXNzaW5nLlwiKTtcbiAgICAgICAgICAgIHJldHVybiBmYWxzZTtcbiAgICAgICAgfVxuXG4gICAgICAgIGlmICh2YWx1ZXMgPT09IHVuZGVmaW5lZCB8fCB2YWx1ZXMgPT09IG51bGwgfHwgdmFsdWVzLmxlbmd0aCA9PT0gMCkge1xuICAgICAgICAgICAgbG9nZ2VyLmVycm9yKG5hbWUsIFwidmFsdWVzIGFyZSBtaXNzaW5nLlwiKTtcbiAgICAgICAgICAgIHJldHVybiBmYWxzZTtcbiAgICAgICAgfVxuXG4gICAgICAgIGlmICh2YWx1ZXMuaW5kZXhPZih2YWx1ZSkgPT09IC0xKSB7XG4gICAgICAgICAgICBpZiAoZXJyb3IpIHtcbiAgICAgICAgICAgICAgICBsb2dnZXIuZXJyb3IobmFtZSwgZXJyb3IpO1xuICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICBsb2dnZXIuZXJyb3IobmFtZSwgYGRvZXMgbm90IG1hdGNoIGFueSBvZiB0aGUgcG9zc2libGUgdmFsdWVzLiBbJHt2YWx1ZXMuam9pbihcIixcIil9XWApO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgICAgICB9XG5cbiAgICAgICAgbG9nZ2VyLmluZm8obmFtZSwgeyB2YWx1ZSB9KTtcblxuICAgICAgICByZXR1cm4gdHJ1ZTtcbiAgICB9XG5cbiAgICBwdWJsaWMgc3RhdGljIG5vdEVtcHR5KGxvZ2dlcjogSUxvZ2dlciwgbmFtZTogc3RyaW5nLCB2YWx1ZTogc3RyaW5nIHwgc3RyaW5nW10gfCB1bmRlZmluZWQgfCBudWxsKTogYm9vbGVhbiB7XG4gICAgICAgIGlmICh2YWx1ZSA9PT0gdW5kZWZpbmVkIHx8IHZhbHVlID09PSBudWxsIHx8IHZhbHVlLmxlbmd0aCA9PT0gMCkge1xuICAgICAgICAgICAgbG9nZ2VyLmVycm9yKG5hbWUsIFwicGFyYW1ldGVyIGlzIG1pc3NpbmcuXCIpO1xuICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgICAgICB9XG5cbiAgICAgICAgbG9nZ2VyLmluZm8obmFtZSwgeyB2YWx1ZSB9KTtcblxuICAgICAgICByZXR1cm4gdHJ1ZTtcbiAgICB9XG5cbiAgICBwdWJsaWMgc3RhdGljIG5vdEVtcHR5TnVtYmVyKGxvZ2dlcjogSUxvZ2dlciwgbmFtZTogc3RyaW5nLCB2YWx1ZTogbnVtYmVyIHwgdW5kZWZpbmVkIHwgbnVsbCk6IGJvb2xlYW4ge1xuICAgICAgICBpZiAodmFsdWUgPT09IHVuZGVmaW5lZCB8fCB2YWx1ZSA9PT0gbnVsbCkge1xuICAgICAgICAgICAgbG9nZ2VyLmVycm9yKG5hbWUsIFwicGFyYW1ldGVyIGlzIG1pc3NpbmcuXCIpO1xuICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgICAgICB9XG5cbiAgICAgICAgaWYgKHZhbHVlIDw9IDApIHtcbiAgICAgICAgICAgIGxvZ2dlci5lcnJvcihuYW1lLCBcIm11c3QgYmUgZ3JlYXRlciB0aGFuIHplcm8uXCIpO1xuICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgICAgICB9XG5cbiAgICAgICAgbG9nZ2VyLmluZm8obmFtZSwgeyB2YWx1ZSB9KTtcblxuICAgICAgICByZXR1cm4gdHJ1ZTtcbiAgICB9XG5cbiAgICBwdWJsaWMgc3RhdGljIGlzQ29sb3IobG9nZ2VyOiBJTG9nZ2VyLCBuYW1lOiBzdHJpbmcsIHZhbHVlOiBzdHJpbmcgfCB1bmRlZmluZWQgfCBudWxsKTogYm9vbGVhbiB7XG4gICAgICAgIGlmICh2YWx1ZSA9PT0gdW5kZWZpbmVkIHx8IHZhbHVlID09PSBudWxsIHx8IHZhbHVlLmxlbmd0aCA9PT0gMCkge1xuICAgICAgICAgICAgbG9nZ2VyLmVycm9yKG5hbWUsIFwicGFyYW1ldGVyIGlzIG1pc3NpbmcuXCIpO1xuICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgICAgICB9XG5cbiAgICAgICAgaWYgKCFDb2xvckhlbHBlci5pc0hleCh2YWx1ZSkpIHtcbiAgICAgICAgICAgIGxvZ2dlci5lcnJvcihuYW1lLCBcImlzIG5vdCBhIGhleCBjb2xvci5cIik7XG4gICAgICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgICAgIH1cblxuICAgICAgICBsb2dnZXIuaW5mbyhuYW1lLCB7IHZhbHVlIH0pO1xuXG4gICAgICAgIHJldHVybiB0cnVlO1xuICAgIH1cbn1cbiJdfQ==
