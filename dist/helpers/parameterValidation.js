"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
const colorHelper_1 = require("./colorHelper");
class ParameterValidation {
    static checkPackageName(logger, name, value) {
        // Rules from here https://docs.npmjs.com/files/package.json
        // here https://github.com/npm/validate-npm-package-name
        // and here https://github.com/npm/npm-registry-couchapp/
        // blob/b31793881ff95c5bca5966a0a8bf8e5f7a801247/registry/modules.js#L93
        if (value === undefined || value === null || value.length === 0) {
            logger.error(name, "parameter is missing.");
            return false;
        }
        if (value.length > 214) {
            logger.error(name, "must be less than or equal to 214 characters.");
            return false;
        }
        if (value.toLowerCase() !== value) {
            logger.error(name, "must not have uppercase letters in it.");
            return false;
        }
        if (value[0] === "." || value[0] === "-" || value[0] === "_") {
            logger.error(name, "must not start with a dot, hyphen or underscore.");
            return false;
        }
        if (value.match(/[\/\\\(\)&\?#\|<>@:%\s\*'"!~`]/)) {
            logger.error(name, "must not have any special characters.");
            return false;
        }
        if (encodeURIComponent(value) !== value) {
            logger.error(name, "can't contain any non-URL-safe characters.");
            return false;
        }
        logger.info(name, { value });
        return true;
    }
    static checkPattern(logger, name, value, pattern, patternExplain) {
        if (value === undefined || value === null || value.length === 0) {
            logger.error(name, "parameter is missing.");
            return false;
        }
        if (pattern === undefined || pattern === null) {
            logger.error(name, "pattern is missing.");
            return false;
        }
        if (!pattern.test(value)) {
            logger.error(name, `does not match pattern ${patternExplain}.`);
            return false;
        }
        logger.info(name, { value });
        return true;
    }
    static checkOneOf(logger, name, value, values, error) {
        if (value === undefined || value === null || value.length === 0) {
            logger.error(name, "parameter is missing.");
            return false;
        }
        if (values === undefined || values === null || values.length === 0) {
            logger.error(name, "values are missing.");
            return false;
        }
        if (values.indexOf(value) === -1) {
            if (error) {
                logger.error(name, error);
            }
            else {
                logger.error(name, `does not match any of the possible values. [${values.join(",")}]`);
            }
            return false;
        }
        logger.info(name, { value });
        return true;
    }
    static notEmpty(logger, name, value) {
        if (value === undefined || value === null || value.length === 0) {
            logger.error(name, "parameter is missing.");
            return false;
        }
        logger.info(name, { value });
        return true;
    }
    static notEmptyNumber(logger, name, value) {
        if (value === undefined || value === null) {
            logger.error(name, "parameter is missing.");
            return false;
        }
        if (value <= 0) {
            logger.error(name, "must be greater than zero.");
            return false;
        }
        logger.info(name, { value });
        return true;
    }
    static isColor(logger, name, value) {
        if (value === undefined || value === null || value.length === 0) {
            logger.error(name, "parameter is missing.");
            return false;
        }
        if (!colorHelper_1.ColorHelper.isHex(value)) {
            logger.error(name, "is not a hex color.");
            return false;
        }
        logger.info(name, { value });
        return true;
    }
}
exports.ParameterValidation = ParameterValidation;

//# sourceMappingURL=data:application/json;charset=utf8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi4uLy4uL3NyYy9oZWxwZXJzL3BhcmFtZXRlclZhbGlkYXRpb24udHMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6Ijs7QUFJQSwrQ0FBNEM7QUFFNUMsTUFBYSxtQkFBbUI7SUFDckIsTUFBTSxDQUFDLGdCQUFnQixDQUFDLE1BQWUsRUFBRSxJQUFZLEVBQUUsS0FBZ0M7UUFDMUYsNERBQTREO1FBQzVELHdEQUF3RDtRQUN4RCx5REFBeUQ7UUFDekQsd0VBQXdFO1FBQ3hFLElBQUksS0FBSyxLQUFLLFNBQVMsSUFBSSxLQUFLLEtBQUssSUFBSSxJQUFJLEtBQUssQ0FBQyxNQUFNLEtBQUssQ0FBQyxFQUFFO1lBQzdELE1BQU0sQ0FBQyxLQUFLLENBQUMsSUFBSSxFQUFFLHVCQUF1QixDQUFDLENBQUM7WUFDNUMsT0FBTyxLQUFLLENBQUM7U0FDaEI7UUFFRCxJQUFJLEtBQUssQ0FBQyxNQUFNLEdBQUcsR0FBRyxFQUFFO1lBQ3BCLE1BQU0sQ0FBQyxLQUFLLENBQUMsSUFBSSxFQUFFLCtDQUErQyxDQUFDLENBQUM7WUFDcEUsT0FBTyxLQUFLLENBQUM7U0FDaEI7UUFFRCxJQUFJLEtBQUssQ0FBQyxXQUFXLEVBQUUsS0FBSyxLQUFLLEVBQUU7WUFDL0IsTUFBTSxDQUFDLEtBQUssQ0FBQyxJQUFJLEVBQUUsd0NBQXdDLENBQUMsQ0FBQztZQUM3RCxPQUFPLEtBQUssQ0FBQztTQUNoQjtRQUVELElBQUksS0FBSyxDQUFDLENBQUMsQ0FBQyxLQUFLLEdBQUcsSUFBSSxLQUFLLENBQUMsQ0FBQyxDQUFDLEtBQUssR0FBRyxJQUFJLEtBQUssQ0FBQyxDQUFDLENBQUMsS0FBSyxHQUFHLEVBQUU7WUFDMUQsTUFBTSxDQUFDLEtBQUssQ0FBQyxJQUFJLEVBQUUsa0RBQWtELENBQUMsQ0FBQztZQUN2RSxPQUFPLEtBQUssQ0FBQztTQUNoQjtRQUVELElBQUksS0FBSyxDQUFDLEtBQUssQ0FBQyxnQ0FBZ0MsQ0FBQyxFQUFFO1lBQy9DLE1BQU0sQ0FBQyxLQUFLLENBQUMsSUFBSSxFQUFFLHVDQUF1QyxDQUFDLENBQUM7WUFDNUQsT0FBTyxLQUFLLENBQUM7U0FDaEI7UUFFRCxJQUFJLGtCQUFrQixDQUFDLEtBQUssQ0FBQyxLQUFLLEtBQUssRUFBRTtZQUNyQyxNQUFNLENBQUMsS0FBSyxDQUFDLElBQUksRUFBRSw0Q0FBNEMsQ0FBQyxDQUFDO1lBQ2pFLE9BQU8sS0FBSyxDQUFDO1NBQ2hCO1FBRUQsTUFBTSxDQUFDLElBQUksQ0FBQyxJQUFJLEVBQUUsRUFBRSxLQUFLLEVBQUUsQ0FBQyxDQUFDO1FBRTdCLE9BQU8sSUFBSSxDQUFDO0lBQ2hCLENBQUM7SUFFTSxNQUFNLENBQUMsWUFBWSxDQUFDLE1BQWUsRUFBRSxJQUFZLEVBQUUsS0FBZ0MsRUFBRSxPQUFlLEVBQUUsY0FBc0I7UUFDL0gsSUFBSSxLQUFLLEtBQUssU0FBUyxJQUFJLEtBQUssS0FBSyxJQUFJLElBQUksS0FBSyxDQUFDLE1BQU0sS0FBSyxDQUFDLEVBQUU7WUFDN0QsTUFBTSxDQUFDLEtBQUssQ0FBQyxJQUFJLEVBQUUsdUJBQXVCLENBQUMsQ0FBQztZQUM1QyxPQUFPLEtBQUssQ0FBQztTQUNoQjtRQUVELElBQUksT0FBTyxLQUFLLFNBQVMsSUFBSSxPQUFPLEtBQUssSUFBSSxFQUFFO1lBQzNDLE1BQU0sQ0FBQyxLQUFLLENBQUMsSUFBSSxFQUFFLHFCQUFxQixDQUFDLENBQUM7WUFDMUMsT0FBTyxLQUFLLENBQUM7U0FDaEI7UUFFRCxJQUFJLENBQUMsT0FBTyxDQUFDLElBQUksQ0FBQyxLQUFLLENBQUMsRUFBRTtZQUN0QixNQUFNLENBQUMsS0FBSyxDQUFDLElBQUksRUFBRSwwQkFBMEIsY0FBYyxHQUFHLENBQUMsQ0FBQztZQUNoRSxPQUFPLEtBQUssQ0FBQztTQUNoQjtRQUVELE1BQU0sQ0FBQyxJQUFJLENBQUMsSUFBSSxFQUFFLEVBQUUsS0FBSyxFQUFFLENBQUMsQ0FBQztRQUU3QixPQUFPLElBQUksQ0FBQztJQUNoQixDQUFDO0lBRU0sTUFBTSxDQUFDLFVBQVUsQ0FBbUIsTUFBZSxFQUFFLElBQVksRUFBRSxLQUEyQixFQUFFLE1BQVcsRUFBRSxLQUFjO1FBQzlILElBQUksS0FBSyxLQUFLLFNBQVMsSUFBSSxLQUFLLEtBQUssSUFBSSxJQUFJLEtBQUssQ0FBQyxNQUFNLEtBQUssQ0FBQyxFQUFFO1lBQzdELE1BQU0sQ0FBQyxLQUFLLENBQUMsSUFBSSxFQUFFLHVCQUF1QixDQUFDLENBQUM7WUFDNUMsT0FBTyxLQUFLLENBQUM7U0FDaEI7UUFFRCxJQUFJLE1BQU0sS0FBSyxTQUFTLElBQUksTUFBTSxLQUFLLElBQUksSUFBSSxNQUFNLENBQUMsTUFBTSxLQUFLLENBQUMsRUFBRTtZQUNoRSxNQUFNLENBQUMsS0FBSyxDQUFDLElBQUksRUFBRSxxQkFBcUIsQ0FBQyxDQUFDO1lBQzFDLE9BQU8sS0FBSyxDQUFDO1NBQ2hCO1FBRUQsSUFBSSxNQUFNLENBQUMsT0FBTyxDQUFDLEtBQUssQ0FBQyxLQUFLLENBQUMsQ0FBQyxFQUFFO1lBQzlCLElBQUksS0FBSyxFQUFFO2dCQUNQLE1BQU0sQ0FBQyxLQUFLLENBQUMsSUFBSSxFQUFFLEtBQUssQ0FBQyxDQUFDO2FBQzdCO2lCQUFNO2dCQUNILE1BQU0sQ0FBQyxLQUFLLENBQUMsSUFBSSxFQUFFLCtDQUErQyxNQUFNLENBQUMsSUFBSSxDQUFDLEdBQUcsQ0FBQyxHQUFHLENBQUMsQ0FBQzthQUMxRjtZQUNELE9BQU8sS0FBSyxDQUFDO1NBQ2hCO1FBRUQsTUFBTSxDQUFDLElBQUksQ0FBQyxJQUFJLEVBQUUsRUFBRSxLQUFLLEVBQUUsQ0FBQyxDQUFDO1FBRTdCLE9BQU8sSUFBSSxDQUFDO0lBQ2hCLENBQUM7SUFFTSxNQUFNLENBQUMsUUFBUSxDQUFDLE1BQWUsRUFBRSxJQUFZLEVBQUUsS0FBMkM7UUFDN0YsSUFBSSxLQUFLLEtBQUssU0FBUyxJQUFJLEtBQUssS0FBSyxJQUFJLElBQUksS0FBSyxDQUFDLE1BQU0sS0FBSyxDQUFDLEVBQUU7WUFDN0QsTUFBTSxDQUFDLEtBQUssQ0FBQyxJQUFJLEVBQUUsdUJBQXVCLENBQUMsQ0FBQztZQUM1QyxPQUFPLEtBQUssQ0FBQztTQUNoQjtRQUVELE1BQU0sQ0FBQyxJQUFJLENBQUMsSUFBSSxFQUFFLEVBQUUsS0FBSyxFQUFFLENBQUMsQ0FBQztRQUU3QixPQUFPLElBQUksQ0FBQztJQUNoQixDQUFDO0lBRU0sTUFBTSxDQUFDLGNBQWMsQ0FBQyxNQUFlLEVBQUUsSUFBWSxFQUFFLEtBQWdDO1FBQ3hGLElBQUksS0FBSyxLQUFLLFNBQVMsSUFBSSxLQUFLLEtBQUssSUFBSSxFQUFFO1lBQ3ZDLE1BQU0sQ0FBQyxLQUFLLENBQUMsSUFBSSxFQUFFLHVCQUF1QixDQUFDLENBQUM7WUFDNUMsT0FBTyxLQUFLLENBQUM7U0FDaEI7UUFFRCxJQUFJLEtBQUssSUFBSSxDQUFDLEVBQUU7WUFDWixNQUFNLENBQUMsS0FBSyxDQUFDLElBQUksRUFBRSw0QkFBNEIsQ0FBQyxDQUFDO1lBQ2pELE9BQU8sS0FBSyxDQUFDO1NBQ2hCO1FBRUQsTUFBTSxDQUFDLElBQUksQ0FBQyxJQUFJLEVBQUUsRUFBRSxLQUFLLEVBQUUsQ0FBQyxDQUFDO1FBRTdCLE9BQU8sSUFBSSxDQUFDO0lBQ2hCLENBQUM7SUFFTSxNQUFNLENBQUMsT0FBTyxDQUFDLE1BQWUsRUFBRSxJQUFZLEVBQUUsS0FBZ0M7UUFDakYsSUFBSSxLQUFLLEtBQUssU0FBUyxJQUFJLEtBQUssS0FBSyxJQUFJLElBQUksS0FBSyxDQUFDLE1BQU0sS0FBSyxDQUFDLEVBQUU7WUFDN0QsTUFBTSxDQUFDLEtBQUssQ0FBQyxJQUFJLEVBQUUsdUJBQXVCLENBQUMsQ0FBQztZQUM1QyxPQUFPLEtBQUssQ0FBQztTQUNoQjtRQUVELElBQUksQ0FBQyx5QkFBVyxDQUFDLEtBQUssQ0FBQyxLQUFLLENBQUMsRUFBRTtZQUMzQixNQUFNLENBQUMsS0FBSyxDQUFDLElBQUksRUFBRSxxQkFBcUIsQ0FBQyxDQUFDO1lBQzFDLE9BQU8sS0FBSyxDQUFDO1NBQ2hCO1FBRUQsTUFBTSxDQUFDLElBQUksQ0FBQyxJQUFJLEVBQUUsRUFBRSxLQUFLLEVBQUUsQ0FBQyxDQUFDO1FBRTdCLE9BQU8sSUFBSSxDQUFDO0lBQ2hCLENBQUM7Q0FDSjtBQWpJRCxrREFpSUMiLCJmaWxlIjoiaGVscGVycy9wYXJhbWV0ZXJWYWxpZGF0aW9uLmpzIiwic291cmNlc0NvbnRlbnQiOlsiLyoqXG4gKiBQYXJhbWV0ZXIgdmFsaWRhdGlvbi5cbiAqL1xuaW1wb3J0IHsgSUxvZ2dlciB9IGZyb20gXCIuLi9pbnRlcmZhY2VzL0lMb2dnZXJcIjtcbmltcG9ydCB7IENvbG9ySGVscGVyIH0gZnJvbSBcIi4vY29sb3JIZWxwZXJcIjtcblxuZXhwb3J0IGNsYXNzIFBhcmFtZXRlclZhbGlkYXRpb24ge1xuICAgIHB1YmxpYyBzdGF0aWMgY2hlY2tQYWNrYWdlTmFtZShsb2dnZXI6IElMb2dnZXIsIG5hbWU6IHN0cmluZywgdmFsdWU6IHN0cmluZyB8IHVuZGVmaW5lZCB8IG51bGwpOiBib29sZWFuIHtcbiAgICAgICAgLy8gUnVsZXMgZnJvbSBoZXJlIGh0dHBzOi8vZG9jcy5ucG1qcy5jb20vZmlsZXMvcGFja2FnZS5qc29uXG4gICAgICAgIC8vIGhlcmUgaHR0cHM6Ly9naXRodWIuY29tL25wbS92YWxpZGF0ZS1ucG0tcGFja2FnZS1uYW1lXG4gICAgICAgIC8vIGFuZCBoZXJlIGh0dHBzOi8vZ2l0aHViLmNvbS9ucG0vbnBtLXJlZ2lzdHJ5LWNvdWNoYXBwL1xuICAgICAgICAvLyBibG9iL2IzMTc5Mzg4MWZmOTVjNWJjYTU5NjZhMGE4YmY4ZTVmN2E4MDEyNDcvcmVnaXN0cnkvbW9kdWxlcy5qcyNMOTNcbiAgICAgICAgaWYgKHZhbHVlID09PSB1bmRlZmluZWQgfHwgdmFsdWUgPT09IG51bGwgfHwgdmFsdWUubGVuZ3RoID09PSAwKSB7XG4gICAgICAgICAgICBsb2dnZXIuZXJyb3IobmFtZSwgXCJwYXJhbWV0ZXIgaXMgbWlzc2luZy5cIik7XG4gICAgICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgICAgIH1cblxuICAgICAgICBpZiAodmFsdWUubGVuZ3RoID4gMjE0KSB7XG4gICAgICAgICAgICBsb2dnZXIuZXJyb3IobmFtZSwgXCJtdXN0IGJlIGxlc3MgdGhhbiBvciBlcXVhbCB0byAyMTQgY2hhcmFjdGVycy5cIik7XG4gICAgICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgICAgIH1cblxuICAgICAgICBpZiAodmFsdWUudG9Mb3dlckNhc2UoKSAhPT0gdmFsdWUpIHtcbiAgICAgICAgICAgIGxvZ2dlci5lcnJvcihuYW1lLCBcIm11c3Qgbm90IGhhdmUgdXBwZXJjYXNlIGxldHRlcnMgaW4gaXQuXCIpO1xuICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgICAgICB9XG5cbiAgICAgICAgaWYgKHZhbHVlWzBdID09PSBcIi5cIiB8fCB2YWx1ZVswXSA9PT0gXCItXCIgfHwgdmFsdWVbMF0gPT09IFwiX1wiKSB7XG4gICAgICAgICAgICBsb2dnZXIuZXJyb3IobmFtZSwgXCJtdXN0IG5vdCBzdGFydCB3aXRoIGEgZG90LCBoeXBoZW4gb3IgdW5kZXJzY29yZS5cIik7XG4gICAgICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgICAgIH1cblxuICAgICAgICBpZiAodmFsdWUubWF0Y2goL1tcXC9cXFxcXFwoXFwpJlxcPyNcXHw8PkA6JVxcc1xcKidcIiF+YF0vKSkge1xuICAgICAgICAgICAgbG9nZ2VyLmVycm9yKG5hbWUsIFwibXVzdCBub3QgaGF2ZSBhbnkgc3BlY2lhbCBjaGFyYWN0ZXJzLlwiKTtcbiAgICAgICAgICAgIHJldHVybiBmYWxzZTtcbiAgICAgICAgfVxuXG4gICAgICAgIGlmIChlbmNvZGVVUklDb21wb25lbnQodmFsdWUpICE9PSB2YWx1ZSkge1xuICAgICAgICAgICAgbG9nZ2VyLmVycm9yKG5hbWUsIFwiY2FuJ3QgY29udGFpbiBhbnkgbm9uLVVSTC1zYWZlIGNoYXJhY3RlcnMuXCIpO1xuICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgICAgICB9XG5cbiAgICAgICAgbG9nZ2VyLmluZm8obmFtZSwgeyB2YWx1ZSB9KTtcblxuICAgICAgICByZXR1cm4gdHJ1ZTtcbiAgICB9XG5cbiAgICBwdWJsaWMgc3RhdGljIGNoZWNrUGF0dGVybihsb2dnZXI6IElMb2dnZXIsIG5hbWU6IHN0cmluZywgdmFsdWU6IHN0cmluZyB8IHVuZGVmaW5lZCB8IG51bGwsIHBhdHRlcm46IFJlZ0V4cCwgcGF0dGVybkV4cGxhaW46IHN0cmluZyk6IGJvb2xlYW4ge1xuICAgICAgICBpZiAodmFsdWUgPT09IHVuZGVmaW5lZCB8fCB2YWx1ZSA9PT0gbnVsbCB8fCB2YWx1ZS5sZW5ndGggPT09IDApIHtcbiAgICAgICAgICAgIGxvZ2dlci5lcnJvcihuYW1lLCBcInBhcmFtZXRlciBpcyBtaXNzaW5nLlwiKTtcbiAgICAgICAgICAgIHJldHVybiBmYWxzZTtcbiAgICAgICAgfVxuXG4gICAgICAgIGlmIChwYXR0ZXJuID09PSB1bmRlZmluZWQgfHwgcGF0dGVybiA9PT0gbnVsbCkge1xuICAgICAgICAgICAgbG9nZ2VyLmVycm9yKG5hbWUsIFwicGF0dGVybiBpcyBtaXNzaW5nLlwiKTtcbiAgICAgICAgICAgIHJldHVybiBmYWxzZTtcbiAgICAgICAgfVxuXG4gICAgICAgIGlmICghcGF0dGVybi50ZXN0KHZhbHVlKSkge1xuICAgICAgICAgICAgbG9nZ2VyLmVycm9yKG5hbWUsIGBkb2VzIG5vdCBtYXRjaCBwYXR0ZXJuICR7cGF0dGVybkV4cGxhaW59LmApO1xuICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgICAgICB9XG5cbiAgICAgICAgbG9nZ2VyLmluZm8obmFtZSwgeyB2YWx1ZSB9KTtcblxuICAgICAgICByZXR1cm4gdHJ1ZTtcbiAgICB9XG5cbiAgICBwdWJsaWMgc3RhdGljIGNoZWNrT25lT2Y8VCBleHRlbmRzIHN0cmluZz4obG9nZ2VyOiBJTG9nZ2VyLCBuYW1lOiBzdHJpbmcsIHZhbHVlOiBUIHwgdW5kZWZpbmVkIHwgbnVsbCwgdmFsdWVzOiBUW10sIGVycm9yPzogc3RyaW5nKTogYm9vbGVhbiB7XG4gICAgICAgIGlmICh2YWx1ZSA9PT0gdW5kZWZpbmVkIHx8IHZhbHVlID09PSBudWxsIHx8IHZhbHVlLmxlbmd0aCA9PT0gMCkge1xuICAgICAgICAgICAgbG9nZ2VyLmVycm9yKG5hbWUsIFwicGFyYW1ldGVyIGlzIG1pc3NpbmcuXCIpO1xuICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgICAgICB9XG5cbiAgICAgICAgaWYgKHZhbHVlcyA9PT0gdW5kZWZpbmVkIHx8IHZhbHVlcyA9PT0gbnVsbCB8fCB2YWx1ZXMubGVuZ3RoID09PSAwKSB7XG4gICAgICAgICAgICBsb2dnZXIuZXJyb3IobmFtZSwgXCJ2YWx1ZXMgYXJlIG1pc3NpbmcuXCIpO1xuICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgICAgICB9XG5cbiAgICAgICAgaWYgKHZhbHVlcy5pbmRleE9mKHZhbHVlKSA9PT0gLTEpIHtcbiAgICAgICAgICAgIGlmIChlcnJvcikge1xuICAgICAgICAgICAgICAgIGxvZ2dlci5lcnJvcihuYW1lLCBlcnJvcik7XG4gICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgIGxvZ2dlci5lcnJvcihuYW1lLCBgZG9lcyBub3QgbWF0Y2ggYW55IG9mIHRoZSBwb3NzaWJsZSB2YWx1ZXMuIFske3ZhbHVlcy5qb2luKFwiLFwiKX1dYCk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgICAgIH1cblxuICAgICAgICBsb2dnZXIuaW5mbyhuYW1lLCB7IHZhbHVlIH0pO1xuXG4gICAgICAgIHJldHVybiB0cnVlO1xuICAgIH1cblxuICAgIHB1YmxpYyBzdGF0aWMgbm90RW1wdHkobG9nZ2VyOiBJTG9nZ2VyLCBuYW1lOiBzdHJpbmcsIHZhbHVlOiBzdHJpbmcgfCBzdHJpbmdbXSB8IHVuZGVmaW5lZCB8IG51bGwpOiBib29sZWFuIHtcbiAgICAgICAgaWYgKHZhbHVlID09PSB1bmRlZmluZWQgfHwgdmFsdWUgPT09IG51bGwgfHwgdmFsdWUubGVuZ3RoID09PSAwKSB7XG4gICAgICAgICAgICBsb2dnZXIuZXJyb3IobmFtZSwgXCJwYXJhbWV0ZXIgaXMgbWlzc2luZy5cIik7XG4gICAgICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgICAgIH1cblxuICAgICAgICBsb2dnZXIuaW5mbyhuYW1lLCB7IHZhbHVlIH0pO1xuXG4gICAgICAgIHJldHVybiB0cnVlO1xuICAgIH1cblxuICAgIHB1YmxpYyBzdGF0aWMgbm90RW1wdHlOdW1iZXIobG9nZ2VyOiBJTG9nZ2VyLCBuYW1lOiBzdHJpbmcsIHZhbHVlOiBudW1iZXIgfCB1bmRlZmluZWQgfCBudWxsKTogYm9vbGVhbiB7XG4gICAgICAgIGlmICh2YWx1ZSA9PT0gdW5kZWZpbmVkIHx8IHZhbHVlID09PSBudWxsKSB7XG4gICAgICAgICAgICBsb2dnZXIuZXJyb3IobmFtZSwgXCJwYXJhbWV0ZXIgaXMgbWlzc2luZy5cIik7XG4gICAgICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgICAgIH1cblxuICAgICAgICBpZiAodmFsdWUgPD0gMCkge1xuICAgICAgICAgICAgbG9nZ2VyLmVycm9yKG5hbWUsIFwibXVzdCBiZSBncmVhdGVyIHRoYW4gemVyby5cIik7XG4gICAgICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgICAgIH1cblxuICAgICAgICBsb2dnZXIuaW5mbyhuYW1lLCB7IHZhbHVlIH0pO1xuXG4gICAgICAgIHJldHVybiB0cnVlO1xuICAgIH1cblxuICAgIHB1YmxpYyBzdGF0aWMgaXNDb2xvcihsb2dnZXI6IElMb2dnZXIsIG5hbWU6IHN0cmluZywgdmFsdWU6IHN0cmluZyB8IHVuZGVmaW5lZCB8IG51bGwpOiBib29sZWFuIHtcbiAgICAgICAgaWYgKHZhbHVlID09PSB1bmRlZmluZWQgfHwgdmFsdWUgPT09IG51bGwgfHwgdmFsdWUubGVuZ3RoID09PSAwKSB7XG4gICAgICAgICAgICBsb2dnZXIuZXJyb3IobmFtZSwgXCJwYXJhbWV0ZXIgaXMgbWlzc2luZy5cIik7XG4gICAgICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgICAgIH1cblxuICAgICAgICBpZiAoIUNvbG9ySGVscGVyLmlzSGV4KHZhbHVlKSkge1xuICAgICAgICAgICAgbG9nZ2VyLmVycm9yKG5hbWUsIFwiaXMgbm90IGEgaGV4IGNvbG9yLlwiKTtcbiAgICAgICAgICAgIHJldHVybiBmYWxzZTtcbiAgICAgICAgfVxuXG4gICAgICAgIGxvZ2dlci5pbmZvKG5hbWUsIHsgdmFsdWUgfSk7XG5cbiAgICAgICAgcmV0dXJuIHRydWU7XG4gICAgfVxufVxuIl19
