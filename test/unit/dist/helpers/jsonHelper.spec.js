"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
/**
 * Tests for JsonHelper.
 */
const Chai = require("chai");
const jsonHelper_1 = require("../../../../dist/helpers/jsonHelper");
describe("JsonHelper", () => {
    it("can be created", () => {
        const obj = new jsonHelper_1.JsonHelper();
        Chai.should().exist(obj);
    });
    describe("stringify", () => {
        it("can return JSON when called with undefined", () => {
            Chai.expect(jsonHelper_1.JsonHelper.stringify(undefined)).to.equal(undefined);
        });
        it("can return JSON when called with null", () => {
            Chai.expect(jsonHelper_1.JsonHelper.stringify(null)).to.equal("null");
        });
        it("can return JSON when called with a string", () => {
            Chai.expect(jsonHelper_1.JsonHelper.stringify("hello")).to.equal(JSON.stringify("hello"));
        });
        it("can return JSON when called with a number", () => {
            Chai.expect(jsonHelper_1.JsonHelper.stringify(10)).to.equal(JSON.stringify(10));
        });
        it("can return JSON when called with a boolean", () => {
            Chai.expect(jsonHelper_1.JsonHelper.stringify(true)).to.equal(JSON.stringify(true));
        });
        it("can return JSON when called with an object", () => {
            Chai.expect(jsonHelper_1.JsonHelper.stringify({ p1: true, p2: 10 })).to.equal(JSON.stringify({ p1: true, p2: 10 }));
        });
        it("can return JSON when called with a recursive object", () => {
            const obj = { p1: true, p2: 10, p3: undefined };
            obj.p3 = obj;
            Chai.expect(jsonHelper_1.JsonHelper.stringify(obj)).to.equal(JSON.stringify({ p1: true, p2: 10 }));
        });
        it("can return formatted JSON when called with a recursive object", () => {
            const obj = { p1: true, p2: 10, p3: undefined };
            obj.p3 = obj;
            Chai.expect(jsonHelper_1.JsonHelper.stringify(obj, "\t")).to.equal(JSON.stringify({ p1: true, p2: 10 }, undefined, "\t"));
        });
    });
    describe("codify", () => {
        it("can return undefined when called with undefined", () => {
            Chai.expect(jsonHelper_1.JsonHelper.codify(undefined)).to.equal(undefined);
        });
        it("can return null when called with null", () => {
            Chai.expect(jsonHelper_1.JsonHelper.codify(null)).to.equal("null");
        });
        it("can return JSON when called with a string", () => {
            Chai.expect(jsonHelper_1.JsonHelper.codify("hello")).to.equal("'hello'");
        });
        it("can return JSON when called with a number", () => {
            Chai.expect(jsonHelper_1.JsonHelper.codify(10)).to.equal(JSON.stringify(10));
        });
        it("can return JSON when called with a boolean", () => {
            Chai.expect(jsonHelper_1.JsonHelper.codify(true)).to.equal(JSON.stringify(true));
        });
        it("can return formatted JSON when called with object", () => {
            Chai.expect(jsonHelper_1.JsonHelper.codify({ p1: true, p2: 10 })).to.equal("{\n\tp1: true,\n\tp2: 10\n}");
        });
        it("can return single quoted JSON when called with hyphenated property", () => {
            Chai.expect(jsonHelper_1.JsonHelper.codify({ p1: true, p2: 10, "p-3": "hello" })).to.equal("{\n\tp1: true,\n\tp2: 10,\n\t'p-3': 'hello'\n}");
        });
        it("can remove quotes from __dirname property", () => {
            Chai.expect(jsonHelper_1.JsonHelper.codify({ p1: "__dirname" })).to.equal("{\n\tp1: __dirname\n}");
        });
    });
    describe("parseCode", () => {
        it("can return undefined when called with undefined", () => {
            Chai.expect(jsonHelper_1.JsonHelper.parseCode(undefined)).to.equal(undefined);
        });
        it("can return null when called with null", () => {
            Chai.expect(jsonHelper_1.JsonHelper.parseCode(null)).to.equal(null);
        });
        it("can replace single quotes with double quotes", () => {
            Chai.expect(jsonHelper_1.JsonHelper.parseCode("{\n\tp1: 'foo'\n, 'p2': 'b\\'ar'}")).to.deep.equal({ p1: "foo", p2: "b'ar" });
        });
        it("can add quotes to unquoted properties", () => {
            Chai.expect(jsonHelper_1.JsonHelper.parseCode("{\n\tp1: \"foo\"\n, \"p2\": \"bar\"}")).to.deep.equal({ p1: "foo", p2: "bar" });
        });
        it("can add quotes to __dirname property", () => {
            Chai.expect(jsonHelper_1.JsonHelper.parseCode("{\n\tp1: __dirname\n}")).to.deep.equal({ p1: "__dirname" });
        });
    });
});

//# sourceMappingURL=data:application/json;charset=utf8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi4uLy4uLy4uLy4uL3Rlc3QvdW5pdC9zcmMvaGVscGVycy9qc29uSGVscGVyLnNwZWMudHMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6Ijs7QUFBQTs7R0FFRztBQUNILDZCQUE2QjtBQUM3QixtRUFBZ0U7QUFFaEUsUUFBUSxDQUFDLFlBQVksRUFBRSxHQUFHLEVBQUU7SUFDeEIsRUFBRSxDQUFDLGdCQUFnQixFQUFFLEdBQUcsRUFBRTtRQUN0QixNQUFNLEdBQUcsR0FBRyxJQUFJLHVCQUFVLEVBQUUsQ0FBQztRQUM3QixJQUFJLENBQUMsTUFBTSxFQUFFLENBQUMsS0FBSyxDQUFDLEdBQUcsQ0FBQyxDQUFDO0lBQzdCLENBQUMsQ0FBQyxDQUFDO0lBRUgsUUFBUSxDQUFDLFdBQVcsRUFBRSxHQUFHLEVBQUU7UUFDdkIsRUFBRSxDQUFDLDRDQUE0QyxFQUFFLEdBQUcsRUFBRTtZQUNsRCxJQUFJLENBQUMsTUFBTSxDQUFDLHVCQUFVLENBQUMsU0FBUyxDQUFDLFNBQVMsQ0FBQyxDQUFDLENBQUMsRUFBRSxDQUFDLEtBQUssQ0FBQyxTQUFTLENBQUMsQ0FBQztRQUNyRSxDQUFDLENBQUMsQ0FBQztRQUVILEVBQUUsQ0FBQyx1Q0FBdUMsRUFBRSxHQUFHLEVBQUU7WUFDN0MsSUFBSSxDQUFDLE1BQU0sQ0FBQyx1QkFBVSxDQUFDLFNBQVMsQ0FBQyxJQUFJLENBQUMsQ0FBQyxDQUFDLEVBQUUsQ0FBQyxLQUFLLENBQUMsTUFBTSxDQUFDLENBQUM7UUFDN0QsQ0FBQyxDQUFDLENBQUM7UUFFSCxFQUFFLENBQUMsMkNBQTJDLEVBQUUsR0FBRyxFQUFFO1lBQ2pELElBQUksQ0FBQyxNQUFNLENBQUMsdUJBQVUsQ0FBQyxTQUFTLENBQUMsT0FBTyxDQUFDLENBQUMsQ0FBQyxFQUFFLENBQUMsS0FBSyxDQUFDLElBQUksQ0FBQyxTQUFTLENBQUMsT0FBTyxDQUFDLENBQUMsQ0FBQztRQUNqRixDQUFDLENBQUMsQ0FBQztRQUVILEVBQUUsQ0FBQywyQ0FBMkMsRUFBRSxHQUFHLEVBQUU7WUFDakQsSUFBSSxDQUFDLE1BQU0sQ0FBQyx1QkFBVSxDQUFDLFNBQVMsQ0FBQyxFQUFFLENBQUMsQ0FBQyxDQUFDLEVBQUUsQ0FBQyxLQUFLLENBQUMsSUFBSSxDQUFDLFNBQVMsQ0FBQyxFQUFFLENBQUMsQ0FBQyxDQUFDO1FBQ3ZFLENBQUMsQ0FBQyxDQUFDO1FBRUgsRUFBRSxDQUFDLDRDQUE0QyxFQUFFLEdBQUcsRUFBRTtZQUNsRCxJQUFJLENBQUMsTUFBTSxDQUFDLHVCQUFVLENBQUMsU0FBUyxDQUFDLElBQUksQ0FBQyxDQUFDLENBQUMsRUFBRSxDQUFDLEtBQUssQ0FBQyxJQUFJLENBQUMsU0FBUyxDQUFDLElBQUksQ0FBQyxDQUFDLENBQUM7UUFDM0UsQ0FBQyxDQUFDLENBQUM7UUFFSCxFQUFFLENBQUMsNENBQTRDLEVBQUUsR0FBRyxFQUFFO1lBQ2xELElBQUksQ0FBQyxNQUFNLENBQUMsdUJBQVUsQ0FBQyxTQUFTLENBQUMsRUFBRSxFQUFFLEVBQUUsSUFBSSxFQUFFLEVBQUUsRUFBRSxFQUFFLEVBQUMsQ0FBQyxDQUFDLENBQUMsRUFBRSxDQUFDLEtBQUssQ0FBQyxJQUFJLENBQUMsU0FBUyxDQUFDLEVBQUUsRUFBRSxFQUFFLElBQUksRUFBRSxFQUFFLEVBQUUsRUFBRSxFQUFDLENBQUMsQ0FBQyxDQUFDO1FBQ3pHLENBQUMsQ0FBQyxDQUFDO1FBRUgsRUFBRSxDQUFDLHFEQUFxRCxFQUFFLEdBQUcsRUFBRTtZQUMzRCxNQUFNLEdBQUcsR0FBeUMsRUFBRSxFQUFFLEVBQUUsSUFBSSxFQUFFLEVBQUUsRUFBRSxFQUFFLEVBQUUsRUFBRSxFQUFFLFNBQVMsRUFBQyxDQUFDO1lBQ3JGLEdBQUcsQ0FBQyxFQUFFLEdBQUcsR0FBRyxDQUFDO1lBQ2IsSUFBSSxDQUFDLE1BQU0sQ0FBQyx1QkFBVSxDQUFDLFNBQVMsQ0FBQyxHQUFHLENBQUMsQ0FBQyxDQUFDLEVBQUUsQ0FBQyxLQUFLLENBQUMsSUFBSSxDQUFDLFNBQVMsQ0FBQyxFQUFFLEVBQUUsRUFBRSxJQUFJ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RUFBRSxFQUFFLEVBQUUsS0FBSyxFQUFDLENBQUMsQ0FBQztRQUNySCxDQUFDLENBQUMsQ0FBQztRQUVILEVBQUUsQ0FBQyxzQ0FBc0MsRUFBRSxHQUFHLEVBQUU7WUFDNUMsSUFBSSxDQUFDLE1BQU0sQ0FBQyx1QkFBVSxDQUFDLFNBQVMsQ0FBQyx1QkFBdUIsQ0FBQyxDQUFDLENBQUMsRUFBRSxDQUFDLElBQUksQ0FBQyxLQUFLLENBQUMsRUFBRSxFQUFFLEVBQUUsV0FBVyxFQUFDLENBQUMsQ0FBQztRQUNqRyxDQUFDLENBQUMsQ0FBQztJQUNQLENBQUMsQ0FBQyxDQUFDO0FBQ1AsQ0FBQyxDQUFDLENBQUMiLCJmaWxlIjoiaGVscGVycy9qc29uSGVscGVyLnNwZWMuanMiLCJzb3VyY2VzQ29udGVudCI6WyIvKipcbiAqIFRlc3RzIGZvciBKc29uSGVscGVyLlxuICovXG5pbXBvcnQgKiBhcyBDaGFpIGZyb20gXCJjaGFpXCI7XG5pbXBvcnQgeyBKc29uSGVscGVyIH0gZnJvbSBcIi4uLy4uLy4uLy4uL3NyYy9oZWxwZXJzL2pzb25IZWxwZXJcIjtcblxuZGVzY3JpYmUoXCJKc29uSGVscGVyXCIsICgpID0+IHtcbiAgICBpdChcImNhbiBiZSBjcmVhdGVkXCIsICgpID0+IHtcbiAgICAgICAgY29uc3Qgb2JqID0gbmV3IEpzb25IZWxwZXIoKTtcbiAgICAgICAgQ2hhaS5zaG91bGQoKS5leGlzdChvYmopO1xuICAgIH0pO1xuXG4gICAgZGVzY3JpYmUoXCJzdHJpbmdpZnlcIiwgKCkgPT4ge1xuICAgICAgICBpdChcImNhbiByZXR1cm4gSlNPTiB3aGVuIGNhbGxlZCB3aXRoIHVuZGVmaW5lZFwiLCAoKSA9PiB7XG4gICAgICAgICAgICBDaGFpLmV4cGVjdChKc29uSGVscGVyLnN0cmluZ2lmeSh1bmRlZmluZWQpKS50by5lcXVhbCh1bmRlZmluZWQpO1xuICAgICAgICB9KTtcblxuICAgICAgICBpdChcImNhbiByZXR1cm4gSlNPTiB3aGVuIGNhbGxlZCB3aXRoIG51bGxcIiwgKCkgPT4ge1xuICAgICAgICAgICAgQ2hhaS5leHBlY3QoSnNvbkhlbHBlci5zdHJpbmdpZnkobnVsbCkpLnRvLmVxdWFsKFwibnVsbFwiKTtcbiAgICAgICAgfSk7XG5cbiAgICAgICAgaXQoXCJjYW4gcmV0dXJuIEpTT04gd2hlbiBjYWxsZWQgd2l0aCBhIHN0cmluZ1wiLCAoKSA9PiB7XG4gICAgICAgICAgICBDaGFpLmV4cGVjdChKc29uSGVscGVyLnN0cmluZ2lmeShcImhlbGxvXCIpKS50by5lcXVhbChKU09OLnN0cmluZ2lmeShcImhlbGxvXCIpKTtcbiAgICAgICAgfSk7XG5cbiAgICAgICAgaXQoXCJjYW4gcmV0dXJuIEpTT04gd2hlbiBjYWxsZWQgd2l0aCBhIG51bWJlclwiLCAoKSA9PiB7XG4gICAgICAgICAgICBDaGFpLmV4cGVjdChKc29uSGVscGVyLnN0cmluZ2lmeSgxMCkpLnRvLmVxdWFsKEpTT04uc3RyaW5naWZ5KDEwKSk7XG4gICAgICAgIH0pO1xuXG4gICAgICAgIGl0KFwiY2FuIHJldHVybiBKU09OIHdoZW4gY2FsbGVkIHdpdGggYSBib29sZWFuXCIsICgpID0+IHtcbiAgICAgICAgICAgIENoYWkuZXhwZWN0KEpzb25IZWxwZXIuc3RyaW5naWZ5KHRydWUpKS50by5lcXVhbChKU09OLnN0cmluZ2lmeSh0cnVlKSk7XG4gICAgICAgIH0pO1xuXG4gICAgICAgIGl0KFwiY2FuIHJldHVybiBKU09OIHdoZW4gY2FsbGVkIHdpdGggYW4gb2JqZWN0XCIsICgpID0+IHtcbiAgICAgICAgICAgIENoYWkuZXhwZWN0KEpzb25IZWxwZXIuc3RyaW5naWZ5KHsgcDE6IHRydWUsIHAyOiAxMH0pKS50by5lcXVhbChKU09OLnN0cmluZ2lmeSh7IHAxOiB0cnVlLCBwMjogMTB9KSk7XG4gICAgICAgIH0pO1xuXG4gICAgICAgIGl0KFwiY2FuIHJldHVybiBKU09OIHdoZW4gY2FsbGVkIHdpdGggYSByZWN1cnNpdmUgb2JqZWN0XCIsICgpID0+IHtcbiAgICAgICAgICAgIGNvbnN0IG9iajogeyBwMTogYm9vbGVhbjsgcDI6IG51bWJlcjsgcDM6IGFueSB9ID0geyBwMTogdHJ1ZSwgcDI6IDEwLCBwMzogdW5kZWZpbmVkfTtcbiAgICAgICAgICAgIG9iai5wMyA9IG9iajtcbiAgICAgICAgICAgIENoYWkuZXhwZWN0KEpzb25IZWxwZXIuc3RyaW5naWZ5KG9iaikpLnRvLmVxdWFsKEpTT04uc3RyaW5naWZ5KHsgcDE6IHRydWUsIHAyOiAxMH0pKTtcbiAgICAgICAgfSk7XG5cbiAgICAgICAgaXQoXCJjYW4gcmV0dXJuIGZvcm1hdHRlZCBKU09OIHdoZW4gY2FsbGVkIHdpdGggYSByZWN1cnNpdmUgb2JqZWN0XCIsICgpID0+IHtcbiAgICAgICAgICAgIGNvbnN0IG9iajogeyBwMTogYm9vbGVhbjsgcDI6IG51bWJlcjsgcDM6IGFueSB9ID0geyBwMTogdHJ1ZSwgcDI6IDEwLCBwMzogdW5kZWZpbmVkfTtcbiAgICAgICAgICAgIG9iai5wMyA9IG9iajtcbiAgICAgICAgICAgIENoYWkuZXhwZWN0KEpzb25IZWxwZXIuc3RyaW5naWZ5KG9iaiwgXCJcXHRcIikpLnRvLmVxdWFsKEpTT04uc3RyaW5naWZ5KHsgcDE6IHRydWUsIHAyOiAxMH0sIHVuZGVmaW5lZCwgXCJcXHRcIikpO1xuICAgICAgICB9KTtcbiAgICB9KTtcblxuICAgIGRlc2NyaWJlKFwiY29kaWZ5XCIsICgpID0+IHtcbiAgICAgICAgaXQoXCJjYW4gcmV0dXJuIHVuZGVmaW5lZCB3aGVuIGNhbGxlZCB3aXRoIHVuZGVmaW5lZFwiLCAoKSA9PiB7XG4gICAgICAgICAgICBDaGFpLmV4cGVjdChKc29uSGVscGVyLmNvZGlmeSh1bmRlZmluZWQpKS50by5lcXVhbCh1bmRlZmluZWQpO1xuICAgICAgICB9KTtcblxuICAgICAgICBpdChcImNhbiByZXR1cm4gbnVsbCB3aGVuIGNhbGxlZCB3aXRoIG51bGxcIiwgKCkgPT4ge1xuICAgICAgICAgICAgQ2hhaS5leHBlY3QoSnNvbkhlbHBlci5jb2RpZnkobnVsbCkpLnRvLmVxdWFsKFwibnVsbFwiKTtcbiAgICAgICAgfSk7XG5cbiAgICAgICAgaXQoXCJjYW4gcmV0dXJuIEpTT04gd2hlbiBjYWxsZWQgd2l0aCBhIHN0cmluZ1wiLCAoKSA9PiB7XG4gICAgICAgICAgICBDaGFpLmV4cGVjdChKc29uSGVscGVyLmNvZGlmeShcImhlbGxvXCIpKS50by5lcXVhbChcIidoZWxsbydcIik7XG4gICAgICAgIH0pO1xuXG4gICAgICAgIGl0KFwiY2FuIHJldHVybiBKU09OIHdoZW4gY2FsbGVkIHdpdGggYSBudW1iZXJcIiwgKCkgPT4ge1xuICAgICAgICAgICAgQ2hhaS5leHBlY3QoSnNvbkhlbHBlci5jb2RpZnkoMTApKS50by5lcXVhbChKU09OLnN0cmluZ2lmeSgxMCkpO1xuICAgICAgICB9KTtcblxuICAgICAgICBpdChcImNhbiByZXR1cm4gSlNPTiB3aGVuIGNhbGxlZCB3aXRoIGEgYm9vbGVhblwiLCAoKSA9PiB7XG4gICAgICAgICAgICBDaGFpLmV4cGVjdChKc29uSGVscGVyLmNvZGlmeSh0cnVlKSkudG8uZXF1YWwoSlNPTi5zdHJpbmdpZnkodHJ1ZSkpO1xuICAgICAgICB9KTtcblxuICAgICAgICBpdChcImNhbiByZXR1cm4gZm9ybWF0dGVkIEpTT04gd2hlbiBjYWxsZWQgd2l0aCBvYmplY3RcIiwgKCkgPT4ge1xuICAgICAgICAgICAgQ2hhaS5leHBlY3QoSnNvbkhlbHBlci5jb2RpZnkoeyBwMTogdHJ1ZSwgcDI6IDEwfSkpLnRvLmVxdWFsKFwie1xcblxcdHAxOiB0cnVlLFxcblxcdHAyOiAxMFxcbn1cIik7XG4gICAgICAgIH0pO1xuXG4gICAgICAgIGl0KFwiY2FuIHJldHVybiBzaW5nbGUgcXVvdGVkIEpTT04gd2hlbiBjYWxsZWQgd2l0aCBoeXBoZW5hdGVkIHByb3BlcnR5XCIsICgpID0+IHtcbiAgICAgICAgICAgIENoYWkuZXhwZWN0KEpzb25IZWxwZXIuY29kaWZ5KHsgcDE6IHRydWUsIHAyOiAxMCwgXCJwLTNcIjogXCJoZWxsb1wifSkpLnRvLmVxdWFsKFwie1xcblxcdHAxOiB0cnVlLFxcblxcdHAyOiAxMCxcXG5cXHQncC0zJzogJ2hlbGxvJ1xcbn1cIik7XG4gICAgICAgIH0pO1xuXG4gICAgICAgIGl0KFwiY2FuIHJlbW92ZSBxdW90ZXMgZnJvbSBfX2Rpcm5hbWUgcHJvcGVydHlcIiwgKCkgPT4ge1xuICAgICAgICAgICAgQ2hhaS5leHBlY3QoSnNvbkhlbHBlci5jb2RpZnkoeyBwMTogXCJfX2Rpcm5hbWVcIn0pKS50by5lcXVhbChcIntcXG5cXHRwMTogX19kaXJuYW1lXFxufVwiKTtcbiAgICAgICAgfSk7XG4gICAgfSk7XG5cbiAgICBkZXNjcmliZShcInBhcnNlQ29kZVwiLCAoKSA9PiB7XG4gICAgICAgIGl0KFwiY2FuIHJldHVybiB1bmRlZmluZWQgd2hlbiBjYWxsZWQgd2l0aCB1bmRlZmluZWRcIiwgKCkgPT4ge1xuICAgICAgICAgICAgQ2hhaS5leHBlY3QoSnNvbkhlbHBlci5wYXJzZUNvZGUodW5kZWZpbmVkKSkudG8uZXF1YWwodW5kZWZpbmVkKTtcbiAgICAgICAgfSk7XG5cbiAgICAgICAgaXQoXCJjYW4gcmV0dXJuIG51bGwgd2hlbiBjYWxsZWQgd2l0aCBudWxsXCIsICgpID0+IHtcbiAgICAgICAgICAgIENoYWkuZXhwZWN0KEpzb25IZWxwZXIucGFyc2VDb2RlKG51bGwpKS50by5lcXVhbChudWxsKTtcbiAgICAgICAgfSk7XG5cbiAgICAgICAgaXQoXCJjYW4gcmVwbGFjZSBzaW5nbGUgcXVvdGVzIHdpdGggZG91YmxlIHF1b3Rlc1wiLCAoKSA9PiB7XG4gICAgICAgICAgICBDaGFpLmV4cGVjdChKc29uSGVscGVyLnBhcnNlQ29kZShcIntcXG5cXHRwMTogJ2ZvbydcXG4sICdwMic6ICdiXFxcXCdhcid9XCIpKS50by5kZWVwLmVxdWFsKHsgcDE6IFwiZm9vXCIsIHAyOiBcImInYXJcIn0pO1xuICAgICAgICB9KTtcblxuICAgICAgICBpdChcImNhbiBhZGQgcXVvdGVzIHRvIHVucXVvdGVkIHByb3BlcnRpZXNcIiwgKCkgPT4ge1xuICAgICAgICAgICAgQ2hhaS5leHBlY3QoSnNvbkhlbHBlci5wYXJzZUNvZGUoXCJ7XFxuXFx0cDE6IFxcXCJmb29cXFwiXFxuLCBcXFwicDJcXFwiOiBcXFwiYmFyXFxcIn1cIikpLnRvLmRlZXAuZXF1YWwoeyBwMTogXCJmb29cIiwgcDI6IFwiYmFyXCJ9KTtcbiAgICAgICAgfSk7XG5cbiAgICAgICAgaXQoXCJjYW4gYWRkIHF1b3RlcyB0byBfX2Rpcm5hbWUgcHJvcGVydHlcIiwgKCkgPT4ge1xuICAgICAgICAgICAgQ2hhaS5leHBlY3QoSnNvbkhlbHBlci5wYXJzZUNvZGUoXCJ7XFxuXFx0cDE6IF9fZGlybmFtZVxcbn1cIikpLnRvLmRlZXAuZXF1YWwoeyBwMTogXCJfX2Rpcm5hbWVcIn0pO1xuICAgICAgICB9KTtcbiAgICB9KTtcbn0pO1xuIl19
